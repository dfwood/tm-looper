jQuery(document).ready(function(a){function b(){var b=!0;a.each(j,function(f){var g=a(this),k=!0;if(!g.hasClass("tile-0")){var l=Math.floor(f/i),m=f%i,n=d(g),o=g.attr("data-rot")?g.attr("data-rot"):0,p=o%4,q=e(n,p);if(0<q.length)for(var r=0;r<q.length;r++){var s=-1;switch(q[r]){case"u":l>0&&(s=(l-1)*i+m);break;case"d":h>l+1&&(s=(l+1)*i+m);break;case"l":m>0&&(s=l*i+m-1);break;case"r":i>m+1&&(s=l*i+m+1)}if(s>=0){var t=j.eq(s),u=d(t),v=t.attr("data-rot")?t.attr("data-rot"):0,w=v%4;if(0==u)k=!1;else if(4>u&&u>0){var x=e(u,w),y=c(q[r]);0>a.inArray(y,x)&&(k=!1)}}else k=!1}else k=!1}k?g.addClass("connected"):g.removeClass("connected"),k||(b=!1)}),b?(g.addClass("connected"),j.off("click")):g.removeClass("connected")}function c(a){switch(a){case"u":return"d";case"d":return"u";case"r":return"l";case"l":return"r"}}function d(a){var b=0;return a.hasClass("tile-1")?b=1:a.hasClass("tile-2")?b=2:a.hasClass("tile-3")?b=3:a.hasClass("tile-4")?b=4:a.hasClass("tile-5")&&(b=5),b}function e(a,b){var c=[];switch(a){case 1:switch(b){case 0:case 2:c=["u","d"];break;case 1:case 3:c=["l","r"]}break;case 2:switch(b){case 0:c=["u","l"];break;case 1:c=["u","r"];break;case 2:c=["d","r"];break;case 3:c=["d","l"]}break;case 3:switch(b){case 0:c=["u","r","l"];break;case 1:c=["u","r","d"];break;case 2:c=["d","r","l"];break;case 3:c=["d","l","u"]}break;case 4:c=["u","d","l","r"];break;case 5:switch(b){case 0:c=["u"];break;case 1:c=["r"];break;case 2:c=["d"];break;case 3:c=["l"]}}return c}var f,g=a(".grid"),h=g.attr("data-rows"),i=g.attr("data-cols"),j=a(".grid .tile");j.on("click",function(c){c.preventDefault();var d=a(this);if(!d.hasClass("tile-0")){clearTimeout(f);var e=void 0!==d.attr("data-rot")?d.attr("data-rot"):0;e++;var g=90*e;d.css("transform","rotate("+g+"deg)").attr("data-rot",e).addClass("changing"),f=setTimeout(function(){d.removeClass("changing"),b()},250)}})});